generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Cast {
  id            String                @id @default(uuid())
  name          String
  age           Int
  profile       String
  image_url     String
  created_at    DateTime              @default(now())
  blogs         Blog[]
  badges        CastBadge[]
  features      CastFeatures?
  profiles      CastProfile[]
  memberships   CastStoreMembership[]
  gallery_items GalleryItem[]
  reviews       Review[]
  schedules     Schedule[]
  video_casts   VideoCast[]
}

model Store {
  id               String                @id @default(uuid())
  name             String
  slug             String                @unique
  address          String
  phone            String?
  catch_copy       String?
  image_url        String?
  theme_color      String?
  tags             String[]
  description      String?
  created_at       DateTime              @default(now())
  memberships      CastStoreMembership[]
  schedules        Schedule[]
  videos           Video[]
  price_config     PriceConfig?
  recruit_pages    RecruitPage[]
  store_top_config StoreTopConfig?
  first_time_config FirstTimeConfig?

  @@map("stores")
}

model RecruitPage {
  id          String   @id @default(uuid())
  store_id    String
  section_key String
  content     Json
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
  store       Store    @relation(fields: [store_id], references: [id])

  @@unique([store_id, section_key])
  @@map("recruit_pages")
}

model PageRequest {
  id               String   @id @default(uuid())
  title            String
  slug             String   @unique
  referenceUrls    Json?    @default("[]") @map("reference_urls")
  sections         Json?    @default("[]")
  status           String   @default("draft")
  thumbnailUrl     String?  @map("thumbnail_url")
  targetStoreSlugs String[] @default([]) @map("target_store_slugs")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")

  @@map("page_requests")
}

model StoreTopConfig {
  id         String   @id @default(uuid())
  store_id   String   @unique
  config     Json
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  store      Store    @relation(fields: [store_id], references: [id])

  @@map("store_top_configs")
}

model FirstTimeConfig {
  id         String   @id @default(uuid())
  store_id   String   @unique
  config     Json
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  store      Store    @relation(fields: [store_id], references: [id])

  @@map("first_time_configs")
}


model Schedule {
  id         String   @id @default(uuid())
  cast_id    String
  store_id   String
  work_date  DateTime
  start_time DateTime
  end_time   DateTime
  cast       Cast     @relation(fields: [cast_id], references: [id])
  store      Store    @relation(fields: [store_id], references: [id])
}

model Review {
  id         String      @id @default(uuid())
  cast_id    String
  user_name  String
  rating     Int
  comment    String
  created_at DateTime    @default(now())
  cast       Cast        @relation(fields: [cast_id], references: [id])
  tags       ReviewTag[] @relation("ReviewToReviewTag")
}

model ReviewTag {
  id      String   @id @default(uuid())
  name    String   @unique
  reviews Review[] @relation("ReviewToReviewTag")
}

model GalleryItem {
  id         String   @id @default(uuid())
  cast_id    String
  image_url  String
  caption    String?
  created_at DateTime @default(now())
  cast       Cast     @relation(fields: [cast_id], references: [id])
}

model CastProfile {
  id         String   @id @default(uuid())
  cast_id    String
  title      String
  content    String
  created_at DateTime @default(now())
  cast       Cast     @relation(fields: [cast_id], references: [id])
}

model FeatureMaster {
  id                 String         @id @default(uuid())
  category           String
  name               String
  created_at         DateTime       @default(now())
  cast_appearances   CastFeatures[] @relation("Appearance")
  cast_faces         CastFeatures[] @relation("Face")
  cast_mbtis         CastFeatures[] @relation("Mbti")
  cast_personalities CastFeatures[] @relation("Personality")
}

model CastFeatures {
  id             String         @id @default(uuid())
  cast_id        String         @unique
  personality_id String?
  appearance_id  String?
  mbti_id        String?
  face_id        String?
  created_at     DateTime       @default(now())
  appearance     FeatureMaster? @relation("Appearance", fields: [appearance_id], references: [id])
  cast           Cast           @relation(fields: [cast_id], references: [id])
  face           FeatureMaster? @relation("Face", fields: [face_id], references: [id])
  mbti           FeatureMaster? @relation("Mbti", fields: [mbti_id], references: [id])
  personality    FeatureMaster? @relation("Personality", fields: [personality_id], references: [id])
}

model CastStoreMembership {
  id         String    @id @default(uuid())
  cast_id    String
  store_id   String
  is_primary Boolean   @default(false)
  start_date DateTime
  end_date   DateTime?
  created_at DateTime  @default(now())
  cast       Cast      @relation(fields: [cast_id], references: [id])
  store      Store     @relation(fields: [store_id], references: [id])
}

model Badge {
  id          String      @id @default(uuid())
  name        String      @unique
  cast_badges CastBadge[]
}

model CastBadge {
  id         String   @id @default(uuid())
  cast_id    String
  badge_id   String
  created_at DateTime @default(now())
  badge      Badge    @relation(fields: [badge_id], references: [id])
  cast       Cast     @relation(fields: [cast_id], references: [id])
}

model Blog {
  id         String      @id @default(uuid())
  cast_id    String
  title      String
  content    String
  created_at DateTime    @default(now())
  cast       Cast        @relation(fields: [cast_id], references: [id])
  images     BlogImage[]
  tags       BlogTag[]   @relation("BlogToBlogTag")
}

model BlogImage {
  id        String @id @default(uuid())
  blog_id   String
  image_url String
  blog      Blog   @relation(fields: [blog_id], references: [id])
}

model BlogTag {
  id    String @id @default(uuid())
  name  String
  blogs Blog[] @relation("BlogToBlogTag")
}

model Video {
  id         String         @id @default(uuid())
  store_id   String
  url        String
  created_at DateTime       @default(now())
  store      Store          @relation(fields: [store_id], references: [id])
  casts      VideoCast[]
  feelings   VideoFeeling[] @relation("VideoToVideoFeeling")
  tags       VideoTag[]     @relation("VideoToVideoTag")
}

model VideoCast {
  id       String @id @default(uuid())
  video_id String
  cast_id  String
  cast     Cast   @relation(fields: [cast_id], references: [id])
  video    Video  @relation(fields: [video_id], references: [id])
}

model VideoTag {
  id     String  @id @default(uuid())
  name   String
  videos Video[] @relation("VideoToVideoTag")
}

model VideoFeeling {
  id     String  @id @default(uuid())
  name   String
  videos Video[] @relation("VideoToVideoFeeling")
}

model RecruitApplication {
  id               String         @id @default(uuid())
  type             String
  name             String
  phone            String?
  email            String?
  age              String?
  height           String?
  weight           String?
  address          String?
  message          String?
  store            String?
  status           String         @default("pending")
  simulationResult Json?
  details          Json?
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
  photos           RecruitPhoto[]
}

model RecruitPhoto {
  id            String             @id @default(uuid())
  url           String
  applicationId String
  createdAt     DateTime           @default(now())
  application   RecruitApplication @relation(fields: [applicationId], references: [id], onDelete: Cascade)
}

model PriceConfig {
  id                  String          @id @default(uuid())
  store_id            String          @unique
  hero_image_url      String?
  prohibitions        Json?           @default("[]")
  faqs                Json?           @default("[]")
  cancellation_policy Json?
  updated_at          DateTime        @updatedAt
  created_at          DateTime        @default(now())
  campaigns           Campaign[]
  courses             Course[]
  store               Store           @relation(fields: [store_id], references: [id], onDelete: Cascade)
  options             PriceOption[]
  transport_areas     TransportArea[]

  @@map("price_configs")
}

model Course {
  id                    String       @id @default(uuid())
  price_config_id       String
  course_key            String
  name                  String
  description           String?
  icon                  String?
  extension_per_30min   Int          @default(6000)
  designation_fee_first Int          @default(1000)
  designation_fee_note  String?
  notes                 String?
  display_order         Int          @default(0)
  created_at            DateTime     @default(now())
  updated_at            DateTime     @updatedAt
  plans                 CoursePlan[]
  price_config          PriceConfig  @relation(fields: [price_config_id], references: [id], onDelete: Cascade)

  @@map("courses")
}

model CoursePlan {
  id            String   @id @default(uuid())
  course_id     String
  minutes       Int
  price         Int
  sub_label     String?
  discount_info String?
  display_order Int      @default(0)
  created_at    DateTime @default(now())
  course        Course   @relation(fields: [course_id], references: [id], onDelete: Cascade)

  @@map("course_plans")
}

model TransportArea {
  id              String      @id @default(uuid())
  price_config_id String
  area            String
  price           Int?
  label           String
  note            String?
  display_order   Int         @default(0)
  created_at      DateTime    @default(now())
  price_config    PriceConfig @relation(fields: [price_config_id], references: [id], onDelete: Cascade)

  @@map("transport_areas")
}

model PriceOption {
  id              String      @id @default(uuid())
  price_config_id String
  name            String
  description     String?
  price           Int
  is_relative     Boolean     @default(false)
  display_order   Int         @default(0)
  created_at      DateTime    @default(now())
  price_config    PriceConfig @relation(fields: [price_config_id], references: [id], onDelete: Cascade)

  @@map("price_options")
}

model Campaign {
  id              String      @id @default(uuid())
  price_config_id String
  title           String
  description     String?
  image_url       String?
  need_entry      Boolean     @default(false)
  accent_text     String?
  price_info      String?
  display_order   Int         @default(0)
  created_at      DateTime    @default(now())
  price_config    PriceConfig @relation(fields: [price_config_id], references: [id], onDelete: Cascade)

  @@map("campaigns")
}

model roles {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id    String?   @db.Uuid
  role       String?
  created_at DateTime? @default(now()) @db.Timestamp(6)
}

model lh_amenities {
  id   String  @id @db.Uuid
  name String?
}

model lh_areas {
  city_id String?
  id      String  @id
  name    String?
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lh_article_hotels {
  article_id String?
  hotel_id   String? @db.Uuid

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lh_article_tags {
  article_id String?
  tag        String?

  @@ignore
}

model lh_cities {
  count         Int?
  id            String  @id
  name          String?
  prefecture_id String?
}

model lh_feature_articles {
  article_date  String?
  content       String?
  created_at    DateTime? @db.Timestamptz(6)
  id            String    @id
  image_url     String?
  prefecture_id String?
  summary       String?
  title         String?
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lh_hotel_amenities {
  amenity_id String? @db.Uuid
  hotel_id   String? @db.Uuid

  @@ignore
}

model lh_hotel_images {
  category   String?
  created_at DateTime? @db.Timestamptz(6)
  hotel_id   String?   @db.Uuid
  id         String    @id @db.Uuid
  sort_order Int?
  url        String?
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lh_hotel_services {
  hotel_id   String? @db.Uuid
  service_id String? @db.Uuid

  @@ignore
}

model lh_hotels {
  address                String?
  area_id                String?
  city_id                String?
  created_at             DateTime? @db.Timestamptz(6)
  description            String?
  distance_from_station  String?
  id                     String    @id @db.Uuid
  image_url              String?
  min_price_rest         Int?
  min_price_stay         Int?
  name                   String?
  phone                  String?
  place_id               String?
  prefecture_id          String?
  rating                 Decimal?  @db.Decimal
  rest_price_max_weekday Int?
  rest_price_max_weekend Int?
  rest_price_min_weekday Int?
  rest_price_min_weekend Int?
  review_count           Int?
  room_count             Int?
  status                 String?
  stay_price_max_weekday Int?
  stay_price_max_weekend Int?
  stay_price_min_weekday Int?
  stay_price_min_weekend Int?
  website                String?
}

model lh_prefectures {
  count Int?
  id    String  @id
  name  String?
}

model lh_review_photos {
  category  String?
  id        String  @id @db.Uuid
  review_id String? @db.Uuid
  url       String?
}

model lh_reviews {
  cleanliness Int?
  content     String?
  cost        Int?
  created_at  DateTime? @db.Timestamptz(6)
  hotel_id    String?   @db.Uuid
  id          String    @id @db.Uuid
  rating      Int?
  review_date DateTime? @db.Date
  room_number String?
  rooms       Int?
  service     Int?
  stay_type   String?
  user_name   String?
  value       Int?
}

model lh_services {
  id   String  @id @db.Uuid
  name String?
}

model reservations {
  cast_id               String?   @db.Uuid
  client_nickname       String?
  consent_date          String?
  consent_log_id        String?
  consent_text_snapshot String?
  created_at            DateTime? @db.Timestamptz(6)
  customer_name         String?
  date_time             String?
  email                 String?
  id                    String    @id @db.Uuid
  is_over_18            Boolean?
  notes                 String?
  phone                 String?
  progress_json         Json?
  reservation_datetime  String?
  status                String?
  store_id              String?   @db.Uuid
  therapist_name        String?
  updated_at            DateTime? @db.Timestamptz(6)
  visit_count           Int?
}

model review_tag_links {
  created_at DateTime? @db.Timestamptz(6)
  id         String    @id @db.Uuid
  review_id  String?   @db.Uuid
  tag_id     String?   @db.Uuid
}

model review_tag_master {
  category   String?
  created_at DateTime? @db.Timestamptz(6)
  id         String    @id @db.Uuid
  is_active  Boolean?
  name       String?
}

model review_tags {
  id   String  @id @db.Uuid
  name String?
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model reviews_with_tags_temp {
  cast_id    String?   @db.Uuid
  comment    String?
  created_at DateTime? @db.Timestamp(6)
  rating     Int?
  tags       String?
  user_name  String?

  @@ignore
}

model video_hash_tags {
  id       String  @id @db.Uuid
  tag      String?
  video_id String? @db.Uuid
}

model video_intuitive_tags {
  id       String  @id @db.Uuid
  tag      String?
  video_id String? @db.Uuid
}

model workflow_cast_reflection {
  created_at      DateTime? @db.Timestamptz(6)
  id              String    @id @db.Uuid
  next_action     String?
  reflection_data Json?
  reservation_id  String?   @db.Uuid
  safety_score    Int?
  satisfaction    Int?
}

model workflow_counseling {
  answers        Json?
  created_at     DateTime? @db.Timestamptz(6)
  id             String    @id @db.Uuid
  reservation_id String?   @db.Uuid
}

model workflow_post_survey {
  created_at           DateTime? @db.Timestamptz(6)
  id                   String    @id @db.Uuid
  overall_satisfaction String?
  reservation_id       String?   @db.Uuid
  survey_data          Json?
}

model workflow_reflection {
  created_at         DateTime? @db.Timestamptz(6)
  customer_analysis  String?
  customer_traits    Json?
  has_incident       Boolean?
  id                 String    @id @db.Uuid
  improvement_points Json?
  incident_detail    String?
  next_action        String?
  reservation_id     String?   @db.Uuid
  safety_score       Int?
  satisfaction       Int?
  session_id         String?
  success_memo       String?
  success_points     Json?
  updated_at         DateTime? @db.Timestamptz(6)
}

model workflow_survey {
  arrival_support        String?
  block_a_other          String?
  block_b_other          String?
  block_c_other          String?
  block_d_other          String?
  block_e_other          String?
  booking_ease           String?
  created_at             DateTime? @db.Timestamptz(6)
  desired_hp_content     Json?
  desired_services       Json?
  device_type            String?
  form_version           String?
  free_text              String?
  good_points            Json?
  id                     String    @id @db.Uuid
  improvement_points     Json?
  overall_satisfaction   String?
  price_satisfaction     String?
  recommend_intent       String?
  repeat_intent          String?
  reservation_id         String?   @db.Uuid
  search_keyword         String?
  service_impression     Json?
  session_id             String?
  site_usability         String?
  skipped_flag           Boolean?
  source                 String?
  store_improvements     Json?
  submitted_at           DateTime? @db.Timestamptz(6)
  technical_satisfaction String?
  therapist_name         String?
  updated_at             DateTime? @db.Timestamptz(6)
}
