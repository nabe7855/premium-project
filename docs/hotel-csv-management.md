# ホテル＆口コミCSV管理システム 引き継ぎ資料

## 1. 概要

ホテルデータおよびその口コミデータをCSV形式で一括エクスポート（バックアップ）およびインポート（一括更新・登録）するためのシステムです。
これにより、大量のデータをExcelで編集したり、AIを活用して外部サイトから取得したデータを流し込んだりすることが容易になります。

## 2. 構成ファイル

- **サーバーアクション**: `src/lib/hotel/hotelActions.ts`
  - `exportHotelsToCSV`: DBから全データを取得しCSV化
  - `importHotelsFromCSV`: CSVを解析し、DBへUpsert（更新または作成）
- **管理画面**: `src/app/admin/hotels/page.tsx`
  - ブラウザからエクスポート/インポートを実行するUI
- **外部ライブラリ**: `papaparse` (CSVの解析・生成用)

## 3. CSVフォーマット解説

一つのCSVファイルで「ホテル」と「口コミ」の両方を管理します。一つのホテルに複数の口コミがある場合、同じホテル情報を持つ行が複数並ぶ形式になります。

### 主要なカラム

- **hotel_id**: ホテルの固有ID（既存データの更新時に使用。新規の場合は空欄）
- **hotel_name**: ホテル名
- **review_id**: 口コミの固有ID（既存口コミの更新用）
- **review_content**: 口コミの本文（ここが空の場合は口コミなしとして扱われます）
- **prefecture_id / city_id / area_id**: 各地域のID

## 4. 運用・活用ガイド

### A. 全データのバックアップ

管理画面の「CSVをダウンロード」ボタンを押すと、現在のすべてのホテルデータがPCに保存されます。定期的な実行を推奨します。

### B. AIを活用したデータ収集・一括追加

1. **スクレイピング**: 他のポータルサイト等から、ホテル名、住所、設備、口コミなどの情報を取得します。
2. **AIで整形**: 取得した生データをAI（ChatGPT等）に渡し、以下のプロンプト（例）を与えます：
   > 「以下のホテル情報を、指定のCSVフォーマットに合わせて変換して。hotel_name, address, ... カラムを埋めて。新規追加なので hotel_id は空でいいよ。口コミもあれば review_content に入れて。」
3. **インポート**: AIが書き出したCSVを管理画面からアップロードすれば、一瞬で数百件のデータが追加されます。

### C. 一括修正（住所の一斉変更など）

一度エクスポートしたCSVをExcelやGoogleスプレッドシートで開き、一括置換などでデータを修正した後、再度インポートすれば、`hotel_id` をキーにして既存データが全て一括更新されます。

## 5. 注意事項

- **UUID**: `hotel_id` や `review_id` はデータベースが発行する特殊な文字列（UUID）です。手動で書き換えると別データとして扱われるため、基本的にはエクスポートされたものをそのまま使用してください。
- **画像**: 画像はパス（`/images/cast1.png` など）を文字列として記載します。実際の画像ファイルは `public/images/` フォルダに事前に配置しておく必要があります。
